%script{ src: 'https://cdn.jsdelivr.net/bootstrap.tagsinput/0.8.0/bootstrap-tagsinput.min.js'}
= simple_form_for [:admin, :products, @product] do |f|
  .container
    .row
      .col-lg-2
        = link_to admin_products_products_path, 'data-position': 'bottom', 'data-tooltip': t('keppler.actions.back') do
          .arrow-back.btn.btn-default
            %i.fa.fa-angle-left
            = t('keppler.actions.back')

    .row
      .col-lg-12
        .box.slice-box
          .box-header.with-border
            %h3.box-title= t('keppler.models.pluralize.products').humanize
            .box-tools.pull-right
              %a.btn.btn-box-tool{'data-widget': 'collapse', type: 'button'}
                %i.fa.fa-minus
          .box-body
            %table.table.table-bordered
              %tbody
                .form-padding
                  .col-xs-12.select-categories
                    .col-xs-3
                      = f.input :category_id, collection: @categories, include_blank: 'Selecciona una categoría', input_html: { class: 'category' }, label: 'Categoría'
                  .col-xs-12
                    = f.input :name, as: :string
                  .col-xs-12
                    = f.input :reference, as: :string
                  .col-xs-12
                    = f.input :description, as: :ckeditor, input_html: { ckeditor: { toolbar: 'mini' } }
                  .col-xs-12
                    = f.input :tags, as: :string, input_html: { "data-role" => "tagsinput" }
                  .col-xs-12
                    = f.input :images, as: :keppler_file, multiple: true # , max_size: 225
                  .col-xs-12
                    .pull-right
                      = f.button :submit, t('keppler.actions.save'), name: '_save', class: 'btn-primary'
                      = f.button :submit, t('keppler.actions.save_and_add_another'), name: '_add_other'
.hidden-form
  = simple_form_for @product, url: admin_products_product_select_categories_path(1), method: :post, remote: true do |f|
    = f.input :category_id, input_html: { class: 'category_secret' }
:javascript
  $('.category').change(function(){
    category = $(this).val()
    $('.category_secret').val(category)
    $('.category_secret').parent().parent().submit()
  })
  action = "#{action_name}"
  if((action=="create")||(action=="edit")||(action=="update")){
    $('.category_secret').val("#{@product.category_id}")
    $('.category_secret').parent().parent().submit()
  }

:scss
  .hidden-form{
    display: none;
  }
  .bootstrap-tagsinput{
    border-radius: 15px;
  }
