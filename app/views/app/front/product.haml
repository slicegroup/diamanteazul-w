.container.product-container
  .category-header
    %nav{ "aria-label" => "breadcrumb"}
      %ol.breadcrumb
        - @category&.ancestors.each_with_index do |category, i|
          %li.breadcrumb-item
            = link_to i.zero? ? app_category_path(category) : app_subcategory_path(category) do
              = category.name
        %li.breadcrumb-item
          - if @category.root? && @category.children?
            = link_to @category.name, app_category_path(category)
          - elsif @category.children?
            = link_to @category.name, app_subcategory_path(category)
          - else
            = link_to @category.name, app_products_path(@category)
        %li.breadcrumb-item
          = @product.name
  .product-box
    .product-images
      .product-images-for
        - @product.images.each do |image|
          %img{ src: image.url }
      .product-images-nav
        - @product.images.each do |image|
          %img{ src: image.url }
    .product-description
      %h3= @product&.reference
      %h1= @product.name
      %h4 Características
      %p= raw @product.description
      .formBox
        = simple_form_for @product, url: app_send_cotization_path(@product), html: {id: 'cotization_form'}, method: :get do |f|
          .row
            .col-sm-12
              %h4 Solicitar
          .row
            .col-sm-6
              .inputBox
                %input.input{placeholder: 'Nombre y Apellido', type: "text", name: 'cotization[name]'}
            .col-sm-6
              .inputBox
                %input.input{placeholder: 'Correo electrónico', type: "text", name: 'cotization[email]'}
          .row
            .col-sm-6
              .inputBox
                %input.input{placeholder: 'Teléfono', type: "text", name: 'cotization[phone]'}
            .col-sm-6
              .inputBox
                %textarea.input{placeholder: 'Mensaje', name: 'cotization[message]'}
          .row
            .col-sm-12
              = recaptcha_tags
          .row
            .col-sm-12
              = f.submit 'Enviar', class: 'btn btn-custom'
              / %btn.btn.btn-custom{ type: 'submit' } Enviar
- if flash[:notice].eql?("Mensaje enviado")
  :javascript
    Swal.fire({
      type: 'success',
      title: 'Cotización enviada con éxito'
    })
- elsif flash[:recaptcha_error].eql?("Oh! It's error with reCAPTCHA!")
  :javascript
    Swal.fire({
      type: 'error',
      title: '¡Lo siento!',
      text: 'Hubo un error en el reCAPTCHA, tu reservación no ha sido procesada.'
    })
- elsif flash[:notice].eql?("Mensaje no enviado")
  :javascript
    Swal.fire({
      type: 'error',
      title: '¡Los sentimos!, tu cotización no ha sido procesada. Vuelve a intentarlo.'
    })
:javascript
  $('#cotization_form').validate({
    event: 'blur',
    errorClass: 'error-class',
    validClass: 'valid-class',
     rules: {
       'cotization[name]': { required: true},
       'cotization[email]': { required: true, email: true},
       'cotization[phone]': {required: true, number: true}
      },
     messages: {
       'cotization[name]': 'Indica tu nombre',
       'cotization[email]': 'Indica tu correo',
       'cotization[phone]': 'Indica tu teléfono'
      },
    debug: true,errorElement: 'label',
    submitHandler: function(form){
      form.submit();
    }
  });